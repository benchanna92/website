<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Daily Sales Tracker</title>
  <style>
    :root {
      --color-bg: #ffffff;
      --color-text-primary: #111827;
      --color-text-secondary: #6b7280;
      --color-accent: #111827;
      --color-accent-hover: #333c4a;
      --color-card-bg: #f9fafb;
      --font-heading: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      --font-body: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      --radius: 0.75rem;
      --shadow-light: 0 8px 24px rgba(0,0,0,0.06);
      --transition-default: 0.3s cubic-bezier(0.4,0,0.2,1);
      --max-content-width: 1200px;
      --spacing-lg: 4rem;
      --spacing-md: 2.5rem;
      --spacing-sm: 1.5rem;
    }

    /* Reset and base */
    *, *::before, *::after {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: var(--font-body);
      background-color: var(--color-bg);
      color: var(--color-text-primary);
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    h1, h2 {
      font-family: var(--font-heading);
      font-weight: 700;
      margin: 0;
      color: var(--color-text-primary);
      user-select: none;
    }
    h1 {
      font-size: 3.5rem;
      line-height: 1.1;
      letter-spacing: -0.02em;
    }
    h2 {
      font-size: 2rem;
      margin-bottom: var(--spacing-sm);
    }
    p {
      color: var(--color-text-secondary);
      font-size: 1.125rem;
      margin: 0 0 var(--spacing-md);
      max-width: 600px;
      user-select: none;
    }

    /* Layout */
    .container {
      max-width: var(--max-content-width);
      margin: 0 auto;
      padding-left: var(--spacing-sm);
      padding-right: var(--spacing-sm);
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
    }
    main {
      display: flex;
      flex-direction: column;
      gap: var(--spacing-md);
      padding-bottom: var(--spacing-lg);
      margin-top: var(--spacing-lg);
    }

    /* Header */
    header {
      background: var(--color-bg);
      border-bottom: 1px solid #e5e7eb;
      position: sticky;
      top: 0;
      z-index: 1000;
      padding: var(--spacing-sm) var(--spacing-md);
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 1px 4px rgba(0,0,0,0.05);
    }
    header h1 {
      cursor: default;
      font-weight: 800;
    }
    .header-actions {
      display: flex;
      align-items: center;
      gap: 1rem;
      font-size: 1rem;
      color: var(--color-text-secondary);
      user-select: none;
    }
    .header-actions span.username {
      font-weight: 600;
      color: var(--color-text-primary);
    }
    button {
      cursor: pointer;
      font-weight: 600;
      border-radius: var(--radius);
      border: none;
      padding: 0.625rem 1.5rem;
      background-color: var(--color-accent);
      color: #fff;
      transition: background-color var(--transition-default);
      font-size: 1rem;
      user-select: none;
    }
    button:hover, button:focus {
      background-color: var(--color-accent-hover);
      outline: none;
    }
    button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }

    /* Hero Section */
    #hero {
      text-align: center;
      padding-top: var(--spacing-lg);
      padding-bottom: var(--spacing-lg);
      user-select: none;
    }
    #hero p {
      margin-top: 1rem;
      margin-bottom: 0;
      font-weight: 500;
      color: var(--color-text-secondary);
    }

    /* Card */
    .card {
      background-color: var(--color-card-bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow-light);
      padding: 2.5rem 2rem;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
    }

    /* Forms */
    form {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 1.5rem;
      align-items: end;
    }
    label {
      font-weight: 600;
      font-size: 0.95rem;
      color: var(--color-text-primary);
      display: block;
      margin-bottom: 0.5rem;
      user-select: none;
    }
    input[type="text"],
    input[type="number"],
    input[type="date"],
    input[type="email"] {
      width: 100%;
      padding: 0.6rem 1rem;
      font-size: 1rem;
      border: 1.8px solid #d1d5db;
      border-radius: 0.6rem;
      transition: border-color var(--transition-default), box-shadow var(--transition-default);
      font-family: inherit;
      outline-offset: 1px;
    }
    input[type="text"]:focus,
    input[type="number"]:focus,
    input[type="date"]:focus,
    input[type="email"]:focus {
      outline: none;
      border-color: var(--color-accent);
      box-shadow: 0 0 8px rgba(17,24,39,0.2);
    }

    /* Inputs for login form full width */
    #login-form {
      grid-template-columns: 1fr;
    }

    /* Summary list */
    ul.summary-list {
      margin: 0;
      padding-left: 0;
      list-style: none;
    }
    ul.summary-list li {
      font-weight: 600;
      font-size: 1.1rem;
      padding: 0.55rem 0;
      display: flex;
      justify-content: space-between;
      border-bottom: 1px solid #e5e7eb;
      color: var(--color-text-primary);
      user-select: none;
    }
    ul.summary-list li:last-child {
      border-bottom: none;
    }

    /* Chart container */
    #sales-chart {
      width: 100% !important;
      height: 360px !important;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
      user-select: none;
    }

    /* Hide */
    .hidden {
      display: none !important;
    }

    /* Responsive */
    @media (max-width: 600px) {
      h1 {
        font-size: 2.8rem;
      }
      h2 {
        font-size: 1.65rem;
      }
      form {
        grid-template-columns: 1fr !important;
      }
      button {
        width: 100%;
      }
      #hero {
        padding: 3rem 1.5rem;
      }
    }
  </style>
</head>
<body>
  <header class="container" role="banner" aria-label="Site header">
    <h1>Daily Sales Tracker</h1>
    <div class="header-actions" aria-live="polite" aria-atomic="true">
      <span id="user-label" class="hidden" aria-hidden="false">Logged in as <strong id="username-display"></strong></span>
      <button id="login-btn" type="button">Login</button>
      <button id="logout-btn" type="button" class="hidden">Logout</button>
    </div>
  </header>

  <section id="hero" class="container" aria-label="Introduction">
    <h2>Track Your Daily Sales With Ease</h2>
    <p>Quickly add your daily sales data and view monthly summaries and charts for better insights.</p>
  </section>

  <!-- Login modal dialog -->
  <section id="login-section" class="card container hidden" aria-modal="true" role="dialog" aria-labelledby="login-title" aria-describedby="login-desc">
    <h2 id="login-title">Login to your account</h2>
    <p id="login-desc">Enter your username to access your sales data.</p>
    <form id="login-form" novalidate>
      <label for="login-username">Username</label>
      <input id="login-username" name="username" type="text" autocomplete="username" required minlength="1" />
      <button type="submit">Sign In</button>
      <p id="login-error" style="color:#dc2626; font-weight:600; margin-top:1rem; display:none;" role="alert" aria-live="assertive"></p>
    </form>
  </section>

  <main id="app" class="container hidden" role="main" aria-label="Sales tracking application">
    <section class="card" aria-labelledby="form-header">
      <h2 id="form-header">Add a New Sale</h2>
      <form id="sales-form" novalidate>
        <div>
          <label for="service-input">Service</label>
          <input id="service-input" name="service" type="text" placeholder="Service description" required autocomplete="off" />
        </div>
        <div>
          <label for="price-input">Price ($)</label>
          <input id="price-input" name="price" type="number" placeholder="0.00" min="0" step="0.01" required />
        </div>
        <div>
          <label for="date-input">Date</label>
          <input id="date-input" name="date" type="date" required />
        </div>
        <div>
          <button type="submit">Add Sale</button>
        </div>
      </form>
    </section>

    <section class="card" aria-labelledby="summary-header">
      <h2 id="summary-header">Monthly Sales Summary</h2>
      <ul id="monthly-summary" class="summary-list" role="list" aria-live="polite" aria-relevant="additions removals">
        <!-- monthly totals -->
      </ul>
    </section>

    <section class="card" aria-labelledby="chart-header">
      <h2 id="chart-header">Sales Chart</h2>
      <canvas id="sales-chart" aria-label="Line chart showing sales over time" role="img"></canvas>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    (() => {
      // Elements
      const loginSection = document.getElementById('login-section');
      const loginForm = document.getElementById('login-form');
      const loginUsernameInput = document.getElementById('login-username');
      const loginError = document.getElementById('login-error');

      const app = document.getElementById('app');
      const salesForm = document.getElementById('sales-form');
      const serviceInput = document.getElementById('service-input');
      const priceInput = document.getElementById('price-input');
      const dateInput = document.getElementById('date-input');
      const monthlySummary = document.getElementById('monthly-summary');
      const salesChartCanvas = document.getElementById('sales-chart');

      const loginBtn = document.getElementById('login-btn');
      const logoutBtn = document.getElementById('logout-btn');
      const userLabel = document.getElementById('user-label');
      const usernameDisplay = document.getElementById('username-display');

      // Storage
      const STORAGE_PREFIX = 'dailySales_';
      const SESSION_KEY = 'dailySales_currentUser';

      // State
      let currentUser = null;
      let salesData = [];
      let salesChart = null;

      // Format date YYYY-MM-DD
      function formatDate(date) {
        const d = new Date(date);
        const y = d.getFullYear();
        const m = String(d.getMonth() + 1).padStart(2,'0');
        const day = String(d.getDate()).padStart(2,'0');
        return `${y}-${m}-${day}`;
      }

      // Per user key
      function userStorageKey(user) {
        return STORAGE_PREFIX + user.toLowerCase();
      }

      // Save user session
      function saveSession(user) {
        localStorage.setItem(SESSION_KEY, user);
      }
      // Load user session
      function loadSession() {
        const user = localStorage.getItem(SESSION_KEY);
        if (user && user.trim()) return user;
        return null;
      }
      // Clear session
      function clearSession() {
        localStorage.removeItem(SESSION_KEY);
      }

      // Load sales data for current user
      function loadSales() {
        if (!currentUser) return [];
        const raw = localStorage.getItem(userStorageKey(currentUser));
        if (!raw) return [];
        try {
          const parsed = JSON.parse(raw);
          return Array.isArray(parsed) ? parsed : [];
        } catch {
          return [];
        }
      }

      // Save sales data for current user
      function saveSales(data) {
        if (!currentUser) return;
        localStorage.setItem(userStorageKey(currentUser), JSON.stringify(data));
      }

      // Compute monthly totals
      function computeMonthlyTotals(data) {
        const totals = {};
        for (const {date, price} of data) {
          if (!date || typeof price !== 'number') continue;
          const month = date.slice(0,7);
          totals[month] = (totals[month] || 0) + price;
        }
        return totals;
      }

      // Update monthly summary UI
      function updateMonthlySummary(totals) {
        monthlySummary.innerHTML = '';
        const months = Object.keys(totals).sort((a,b) => b.localeCompare(a));
        if (months.length === 0) {
          const li = document.createElement('li');
          li.textContent = 'No sales data available.';
          monthlySummary.appendChild(li);
          return;
        }
        months.forEach(month => {
          const li = document.createElement('li');
          const dateObj = new Date(month + '-01T00:00');
          const monthName = dateObj.toLocaleString(undefined, {month: 'long', year: 'numeric'});
          li.textContent = monthName;
          const span = document.createElement('span');
          span.textContent = '$' + totals[month].toFixed(2);
          li.appendChild(span);
          monthlySummary.appendChild(li);
        });
      }

      // Prepare chart data
      function prepareChartData(data) {
        const dailyTotals = {};
        for (const {date, price} of data) {
          if (!date || typeof price !== 'number') continue;
          dailyTotals[date] = (dailyTotals[date] || 0) + price;
        }
        const dates = Object.keys(dailyTotals).sort((a,b) => a.localeCompare(b));
        const totals = dates.map(d => dailyTotals[d]);
        return {dates, totals};
      }

      // Initialize chart
      function initChart() {
        const ctx = salesChartCanvas.getContext('2d');
        salesChart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: [],
            datasets: [{
              label: 'Daily Sales ($)',
              data: [],
              fill: true,
              backgroundColor: 'rgba(17, 24, 39, 0.1)',
              borderColor: 'rgba(17,24,39,0.8)',
              borderWidth: 2,
              tension: 0.25,
              pointRadius: 3,
              pointHoverRadius: 6,
              hoverBorderWidth: 2,
              hoverBackgroundColor: 'rgba(17,24,39,0.3)',
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            animation: {duration: 300},
            interaction: {
              mode: 'nearest',
              intersect: false,
            },
            scales: {
              x: {
                type: 'time',
                time: {
                  parser: 'yyyy-MM-dd',
                  unit: 'day',
                  tooltipFormat: 'PP',
                  displayFormats: {
                    day: 'MMM d',
                    month: 'MMM yyyy'
                  }
                },
                title: {
                  display: true,
                  text: 'Date',
                  color: 'rgba(17,24,39,0.7)',
                  font: {weight: '600', size: 14}
                },
                ticks: {
                  color: 'rgba(17,24,39,0.7)'
                },
                grid: {
                  color: '#e5e7eb'
                }
              },
              y: {
                beginAtZero: true,
                title: {
                  display: true,
                  text: 'Sales ($)',
                  color: 'rgba(17,24,39,0.7)',
                  font: {weight: '600', size: 14}
                },
                ticks: {
                  color: 'rgba(17,24,39,0.7)'
                },
                grid: {
                  color: '#e5e7eb'
                }
              }
            },
            plugins: {
              legend: {
                labels: {color: 'rgba(17,24,39,0.8)', font: {weight: '600'}}
              },
              tooltip: {
                mode: 'index',
                intersect: false,
                backgroundColor: 'rgba(17,24,39,0.85)',
                titleColor: '#fff',
                bodyColor: '#fff',
                cornerRadius: 6,
                padding: 8,
              }
            }
          }
        });
      }

      // Update chart with data
      function updateChart(data) {
        if (!salesChart) return;
        const {dates, totals} = prepareChartData(data);
        salesChart.data.labels = dates;
        salesChart.data.datasets[0].data = totals;
        salesChart.update();
      }

      // Show/hide UI states
      function setLoggedIn(user) {
        currentUser = user;
        saveSession(user);
        loginSection.classList.add('hidden');
        app.classList.remove('hidden');
        loginBtn.classList.add('hidden');
        logoutBtn.classList.remove('hidden');
        userLabel.classList.remove('hidden');
        usernameDisplay.textContent = user;
        salesData = loadSales();
        updateMonthlySummary(computeMonthlyTotals(salesData));
        updateChart(salesData);
        serviceInput.focus();
      }
      function setLoggedOut() {
        currentUser = null;
        clearSession();
        salesData = [];
        loginSection.classList.remove('hidden');
        app.classList.add('hidden');
        loginBtn.classList.remove('hidden');
        logoutBtn.classList.add('hidden');
        userLabel.classList.add('hidden');
        usernameDisplay.textContent = '';
        loginUsernameInput.value = '';
        loginError.style.display = 'none';
        loginUsernameInput.focus();
      }

      // Login form submit handler
      loginForm.addEventListener('submit', e => {
        e.preventDefault();
        const username = loginUsernameInput.value.trim();
        if (!username) {
          loginError.textContent = 'Username is required.';
          loginError.style.display = 'block';
          loginUsernameInput.focus();
          return;
        }
        loginError.style.display = 'none';
        setLoggedIn(username);
      });

      // Logout button click handler
      logoutBtn.addEventListener('click', () => {
        setLoggedOut();
      });

      // Sales form submit
      salesForm.addEventListener('submit', e => {
        e.preventDefault();
        if (!currentUser) return; // Should not happen

        const service = serviceInput.value.trim();
        const priceRaw = priceInput.value.trim();
        const date = dateInput.value;

        if (!service) {
          serviceInput.focus();
          return;
        }
        const price = parseFloat(priceRaw);
        if (isNaN(price) || price < 0) {
          priceInput.focus();
          return;
        }
        if (!date) {
          dateInput.focus();
          return;
        }

        salesData.push({ service, price, date });
        saveSales(salesData);
        updateMonthlySummary(computeMonthlyTotals(salesData));
        updateChart(salesData);
        salesForm.reset();
        serviceInput.focus();
      });

      // Initialization
      initChart();
      const savedUser = loadSession();
      if (savedUser) {
        setLoggedIn(savedUser);
      } else {
        setLoggedOut();
      }
    })();
  </script>
</body>
</html>

